2024-11-25 18:23:49,264 - __main__ - INFO - Starting the pipeline execution...
2024-11-25 18:23:49,265 - __main__ - INFO - Reset and Start True
2024-11-25 18:23:49,265 - __main__ - INFO - Resetting pipeline and starting from scratch.
2024-11-25 18:23:49,275 - utils.mongo - INFO - Found 5 collections in database vehicle_db. Deleting them...
2024-11-25 18:23:49,276 - utils.mongo - INFO - Collection 'ev_vehicle_data_raw' has been deleted.
2024-11-25 18:23:49,276 - utils.mongo - INFO - Collection 'vehicles_per_county_year' has been deleted.
2024-11-25 18:23:49,277 - utils.mongo - INFO - Collection 'vehicles_per_make_year' has been deleted.
2024-11-25 18:23:49,278 - utils.mongo - INFO - Collection 'vehicles_per_type_year' has been deleted.
2024-11-25 18:23:49,278 - utils.mongo - INFO - Collection 'ev_vehicle_data_cleaned' has been deleted.
2024-11-25 18:23:49,278 - __main__ - INFO - Running download...
2024-11-25 18:23:49,279 - __main__ - INFO - Executing stage 1...Download...
2024-11-25 18:23:49,279 - pipeline.download - INFO - Starting download from https://data.wa.gov/api/views/f6w7-q2d2/rows.csv
2024-11-25 18:23:49,949 - pipeline.download - INFO - Download completed successfully
2024-11-25 18:24:05,513 - utils.mongo - INFO - Connected to collection: ev_vehicle_data_raw
2024-11-25 18:24:07,030 - utils.mongo - INFO - Inserting data into db - vehicle_db, Collection - ev_vehicle_data_raw
2024-11-25 18:24:10,578 - utils.mongo - INFO - Data inserted successfully into MongoDB!
2024-11-25 18:24:10,886 - __main__ - INFO - Checkpoint saved for stage: download
2024-11-25 18:24:10,887 - __main__ - INFO - Running transform...
2024-11-25 18:24:10,887 - __main__ - INFO - Executing stage 2...Transform...
2024-11-25 18:24:10,887 - utils.mongo - INFO - Getting full data from mongodb (db-vehicle_db, collection-ev_vehicle_data_raw
2024-11-25 18:24:10,889 - utils.mongo - INFO - Connected to collection: ev_vehicle_data_raw
2024-11-25 18:24:14,890 - utils.mongo - INFO - Successfully retrieved 216772 documents from collection ev_vehicle_data_raw.
2024-11-25 18:24:16,801 - pipeline.transform - INFO - Converting data to PySpark DataFrame for fast-distributed computing
2024-11-25 18:24:34,505 - pipeline.transform - INFO - Dropping the following columns
2024-11-25 18:24:34,519 - pipeline.transform - INFO - Filtering ev relevant data
2024-11-25 18:24:36,355 - pipeline.transform - INFO - Transformation completed! Total rows 216732
2024-11-25 18:24:36,355 - pipeline.transform - INFO - Starting conversion of DataFrame to JSON list.
2024-11-25 18:24:39,277 - pipeline.transform - INFO - DataFrame converted to Pandas. Shape: (216732, 12)
2024-11-25 18:24:40,771 - pipeline.transform - INFO - DataFrame converted to list of dictionaries with 216732 records.
2024-11-25 18:24:40,870 - pipeline.transform - INFO - Primary key 'DOL Vehicle ID' successfully set as '_id' in all records.
2024-11-25 18:24:41,922 - pipeline.transform - INFO - Conversion to JSON list completed successfully.
2024-11-25 18:24:42,078 - utils.mongo - INFO - Connected to collection: ev_vehicle_data_cleaned
2024-11-25 18:24:43,227 - utils.mongo - INFO - Inserting data into db - vehicle_db, Collection - ev_vehicle_data_cleaned
2024-11-25 18:24:45,346 - utils.mongo - INFO - Data inserted successfully into MongoDB!
2024-11-25 18:24:45,621 - __main__ - INFO - Checkpoint saved for stage: transform
2024-11-25 18:24:46,029 - __main__ - INFO - Checkpoint saved for stage: transform
2024-11-25 18:24:46,029 - __main__ - INFO - Running analyze...
2024-11-25 18:24:46,030 - __main__ - INFO - Executing stage 3...Analyze...
2024-11-25 18:24:46,032 - utils.mongo - INFO - Connected to collection: ev_vehicle_data_cleaned
2024-11-25 18:24:46,344 - utils.mongo - INFO - Connected to collection: vehicles_per_type_year
2024-11-25 18:24:46,370 - utils.mongo - INFO - Query output saved to new collection 'vehicles_per_type_year' successfully!
2024-11-25 18:24:46,372 - utils.mongo - INFO - Connected to collection: vehicles_per_county_year
2024-11-25 18:24:46,411 - utils.mongo - INFO - Query output saved to new collection 'vehicles_per_county_year' successfully!
2024-11-25 18:24:46,414 - utils.mongo - INFO - Connected to collection: vehicles_per_make_year
2024-11-25 18:24:46,455 - utils.mongo - INFO - Query output saved to new collection 'vehicles_per_make_year' successfully!
2024-11-25 18:24:46,456 - __main__ - INFO - Checkpoint saved for stage: analyze
2024-11-25 18:24:46,457 - __main__ - INFO - Running visualization...
2024-11-25 18:24:46,457 - __main__ - INFO - Executing stage 4...Visualization...
2024-11-25 18:24:46,457 - utils.mongo - INFO - Attempting to fetch data from collection: vehicles_per_type_year
2024-11-25 18:24:46,459 - utils.mongo - INFO - Connected to collection: vehicles_per_type_year
2024-11-25 18:24:46,462 - utils.mongo - INFO - Successfully fetched 32 records from collection: vehicles_per_type_year.
2024-11-25 18:24:46,464 - utils.mongo - INFO - Attempting to fetch data from collection: vehicles_per_county_year
2024-11-25 18:24:46,466 - utils.mongo - INFO - Connected to collection: vehicles_per_county_year
2024-11-25 18:24:46,473 - utils.mongo - INFO - Successfully fetched 881 records from collection: vehicles_per_county_year.
2024-11-25 18:24:46,475 - utils.mongo - INFO - Attempting to fetch data from collection: vehicles_per_make_year
2024-11-25 18:24:46,477 - utils.mongo - INFO - Connected to collection: vehicles_per_make_year
2024-11-25 18:24:46,483 - utils.mongo - INFO - Successfully fetched 270 records from collection: vehicles_per_make_year.
2024-11-25 18:24:47,440 - __main__ - INFO - Checkpoint saved for stage: visualization
2024-11-25 18:24:47,441 - py4j.clientserver - INFO - Closing down clientserver connection
